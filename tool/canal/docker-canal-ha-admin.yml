version: "3"
services:
  zookeeper:
    image: zookeeper:3.6.4
    container_name: zookeeper
    ports:
      - 2181:2181
      - 2888:2888
      - 3888:3888
      - 8080:8080
    networks:
      - my_cluster
  canal-admin:
    image: canal/canal-admin:v1.1.6
    container_name: canal-admin
    volumes:
      - /var/canal-admin/logs/:/home/admin/canal-admin/logs/
    environment:
      - server.port=8089
      - spring.datasource.address=mysql5.7:3306
      - spring.datasource.database=canal_manager
      - spring.datasource.username=root
      - spring.datasource.password=123456
      - spring.datasource.driver-class-name=com.mysql.jdbc.Driver
      - spring.datasource.url=jdbc:mysql://mysql5.7:3306/canal_manager?useUnicode=true&characterEncoding=UTF-8&useSSL=false
      - spring.datasource.hikari.maximum-pool-size=30
      - spring.datasource.hikari.minimum-idle=1
      - canal.adminUser=admin
      - canal.adminPasswd=123456
    ports:
      - 8089:8089
    networks:
      - my_cluster
networks:
  my_cluster:
    external: true